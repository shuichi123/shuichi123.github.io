webpackJsonp([9],{"+ve0":function(t,e){},"0XvF":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("4YfN"),o=i.n(n),r=i("9rMa"),l=i("trJ3"),s=i("zXdv"),a={components:{TokenDialog:l.a},data:function(){return{inputVisible:!1,inputValue:"",form:{title:"",description:"",content:"",type:"",tags:[]},ruleValidate:{title:[{required:!0,message:"请输入标题",trigger:"blur"},{type:"string",max:32,message:"标题长度不大于32字符",trigger:"change"}],description:[{required:!0,message:"请输入博客描述",trigger:"blur"}],content:[{required:!0,message:"请输博客入正文",trigger:"blur"}]},submitButton:{loading:!1,disabled:!1},mavonEditorToolbars:{bold:!0,italic:!0,header:!0,underline:!0,strikethrough:!0,mark:!0,superscript:!0,subscript:!0,quote:!0,ol:!0,ul:!0,link:!0,imagelink:!0,code:!0,table:!0,htmlcode:!0,trash:!0,alignleft:!0,aligncenter:!0,alignright:!0,preview:!0}}},computed:o()({},Object(r.b)(["token","types"])),mounted:function(){var t=this;this.token||this.$nextTick(function(){t.$message({message:"权限不足",type:"error"}),t.$router.go(-1)})},methods:{handleClose:function(t){this.form.tags.splice(this.form.tags.indexOf(t),1)},showInput:function(){var t=this;this.inputVisible=!0,this.$nextTick(function(e){t.$refs.saveTagInput.$refs.input.focus()})},handleInputConfirm:function(){var t=this.inputValue;t&&this.form.tags.push(t),this.inputVisible=!1,this.inputValue=""},select:function(t){},imgAdd:function(t,e){this.$refs.md.$img2Url(t,e.miniurl)},onSubmit:function(){var t=this;this.token?this.publish():this.$refs.tokenDialog.open(function(){t.publish()})},publish:function(){var t=this;this.$refs.form.validate(function(e){if(e){t.submitButton.loading=!0,t.submitButton.disabled=!0;var i={};i.id=t.form.id,i.title=t.form.title,i.content=t.form.content,i.description=t.form.type+">"+t.form.tags.join("&")+"||"+t.form.description,s.a.create(i).then(function(e){var i=e.data;t.$message({message:"发表成功",type:"success"}),t.$router.push("/user/blog/details/"+i.id)}).then(function(){t.submitButton.loading=!1,t.submitButton.disabled=!1})}})}}},u={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{"min-height":"600px"}},[i("el-card",{staticStyle:{"margin-bottom":"20px"},attrs:{shadow:"never"}},[i("el-form",{ref:"form",attrs:{model:t.form,"label-width":"80px",rules:t.ruleValidate}},[i("el-form-item",{attrs:{label:"标题",prop:"title"}},[i("el-input",{model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"分类",prop:"title"}},[i("el-select",{staticStyle:{"padding-right":"12px"},attrs:{placeholder:"请选择分类"},on:{change:t.select},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},t._l(t.types,function(e){return i("el-option-group",{key:e.label,attrs:{label:e.label}},t._l(e.options,function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)}),1)],1),t._v(" "),i("el-form-item",{attrs:{label:"标签",prop:"title"}},[t._l(t.form.tags,function(e){return i("el-tag",{key:e,staticStyle:{"margin-right":"10px"},attrs:{closable:"","disable-transitions":!1},on:{close:function(i){return t.handleClose(e)}}},[t._v(" "+t._s(e)+" ")])}),t._v(" "),t.inputVisible?i("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",staticStyle:{"margin-right":"10px",width:"90px","vertical-align":"bottom"},attrs:{size:"small"},on:{blur:t.handleInputConfirm},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleInputConfirm(e)}},model:{value:t.inputValue,callback:function(e){t.inputValue=e},expression:"inputValue"}}):i("el-button",{staticClass:"button-new-tag",staticStyle:{width:"90px","text-align":"center"},attrs:{size:"small"},on:{click:t.showInput}},[t._v("+ New Tag")])],2),t._v(" "),i("el-form-item",{attrs:{label:"简要说明",prop:"description"}},[i("el-input",{attrs:{type:"textarea"},model:{value:t.form.description,callback:function(e){t.$set(t.form,"description",e)},expression:"form.description"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"博客正文",prop:"content"}},[i("mavon-editor",{ref:"md",staticStyle:{"max-height":"500px"},attrs:{subfield:!1,toolbars:t.mavonEditorToolbars},on:{imgAdd:t.imgAdd},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1),t._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary",loading:t.submitButton.loading,disabled:t.submitButton.disabled},on:{click:t.onSubmit}},[t._v("发表")]),t._v(" "),i("el-button",{on:{click:function(e){return t.$router.push("/user/blog/main")}}},[t._v("返回")])],1)],1)],1),t._v(" "),i("token-dialog",{ref:"tokenDialog"})],1)},staticRenderFns:[]};var c=i("C7Lr")(a,u,!1,function(t){i("+ve0")},null,null);e.default=c.exports}});
//# sourceMappingURL=9.e85892c42bd1da801a03.js.map